# 快速开始指南

## 🚀 快速运行

### 方法1：使用批处理脚本（推荐）

**Windows用户：**

```bash
# 双击运行
run.bat

# 或命令行运行
.\run.bat
```

**如需重新编译：**

```bash
compile.bat
```

### 方法2：使用命令行

```bash
# 编译
javac -encoding UTF-8 -cp "lib/*" -d out/production/SecondHandMarket -sourcepath src src/Main.java src/InitialDataSetup.java

# 运行
java -cp "out/production/SecondHandMarket;lib/*" Main
```

### 方法3：使用IntelliJ IDEA

1. 用IDEA打开项目
2. 右键 `lib/gson-2.10.1.jar` → Add as Library
3. 运行 `Main.java`

---

## 👥 测试账户

系统首次运行时会自动创建以下测试账户：

| 角色 | 用户名 | 密码 | 说明 |
|------|--------|------|------|
| 管理员 | `admin` | `admin123` | 拥有管理员权限 |
| 买家 | `zhangsan` | `123456` | 只能购买商品 |
| 卖家 | `lisi` | `123456` | 只能发布商品 |
| 买卖家 | `wangwu` | `123456` | 可买可卖 |

---

## 📝 快速体验流程

### 1️⃣ 买家购买流程

```
登录 zhangsan (密码: 123456)
→ [1] 浏览商品
→ 选择商品编号购买
→ [3] 我的订单（查看订单状态）
```

### 2️⃣ 卖家发布商品

```
登录 lisi (密码: 123456)
→ [1] 发布商品
→ 输入商品信息（标题、描述、价格等）
→ [2] 我的商品（查看已发布商品）
```

### 3️⃣ 完整交易流程

**步骤1：买家下单**
```
登录 zhangsan
→ 浏览商品
→ 购买 lisi 发布的商品
→ 系统提示：下单成功
```

**步骤2：卖家确认**
```
登录 lisi
→ [3] 我的订单（卖家）
→ [4] 确认订单
→ 选择待确认的订单
```

**步骤3：买家收货**
```
登录 zhangsan
→ [4] 确认收货
→ 选择已确认的订单
→ 确认收货
```

**步骤4：买家评价**
```
登录 zhangsan
→ [5] 评价订单
→ 选择已完成的订单
→ 输入评分和评价内容
```

### 4️⃣ 查看消息通知

```
任意用户登录后
→ [最后一个选项] 我的消息
→ 查看所有系统通知
```

### 5️⃣ 管理员功能

```
登录 admin (密码: admin123)
→ [1] 用户管理（封禁/解封用户）
→ [2] 系统统计（查看系统数据）
```

---

## 🎯 核心功能测试清单

### 用户管理
- ✅ 注册新用户（支持多角色选择）
- ✅ 用户登录/登出
- ✅ 角色权限控制

### 商品管理
- ✅ 发布商品（卖家）
- ✅ 浏览商品（所有人）
- ✅ 搜索商品（关键词、分类、价格）
- ✅ 编辑/下架商品（卖家自己的商品）

### 订单管理
- ✅ 创建订单（买家下单）
- ✅ 确认订单（卖家确认）
- ✅ 确认收货（买家收货）
- ✅ 取消订单（买卖双方均可）
- ✅ 查看订单列表

### 评价管理
- ✅ 评价订单（买家评价已完成订单）
- ✅ 查看评价（卖家查看评价）
- ✅ 信誉分系统（好评+5分，差评-3分）

### 消息通知
- ✅ 登录欢迎消息
- ✅ 订单状态变化通知
- ✅ 实时消息推送

---

## 🔍 技术亮点验证

### 1. EnumSet角色管理

注册时可同时选择买家和卖家角色，系统使用EnumSet管理：

```
注册 → 选择买家(y) → 选择卖家(y) → 同时拥有两种角色
```

### 2. RESERVED中间状态

观察商品状态流转：

```
商品初始状态：AVAILABLE（可售）
→ 买家下单后：RESERVED（已预订）
→ 买家收货后：SOLD（已售出）
→ 如果取消订单：RESERVED → AVAILABLE（恢复可售）
```

### 3. 观察者模式消息通知

每次订单操作都会触发消息通知：

```
下单 → 买家和卖家都收到通知
确认 → 双方收到通知
收货 → 双方收到通知
取消 → 双方收到通知
```

### 4. 依赖注入（AppContext）

启动时查看控制台输出，会显示：

```
[系统] 正在初始化应用上下文...
[系统] DataCenter 初始化完成
[系统] 应用上下文初始化完成
```

### 5. 数据持久化

- 退出系统时自动保存数据到 `data/` 目录
- 重启后数据自动加载
- JSON格式，可直接查看 `data/*.json` 文件

---

## 📂 数据文件位置

所有数据保存在 `data/` 目录：

```
data/
├── users.json      # 用户数据
├── products.json   # 商品数据
├── orders.json     # 订单数据
└── reviews.json    # 评价数据
```

💡 **提示**：如需重置数据，删除 `data/` 目录即可。

---

## ❓ 常见问题

### Q1: 运行时提示找不到Gson类？

**A**: 确保 `lib/gson-2.10.1.jar` 存在，并在运行时包含在classpath中。

### Q2: 中文显示乱码？

**A**: 
- 命令行：运行 `chcp 65001` 设置UTF-8编码
- 或使用提供的 `run.bat` 脚本（已自动设置）

### Q3: 如何重置系统数据？

**A**: 删除 `data/` 目录，重启程序即可重新创建示例数据。

### Q4: 忘记测试账户密码？

**A**: 
- 管理员：admin / admin123
- 其他用户：均为 123456

---

## 🎓 答辩演示建议

### 演示流程（5-8分钟）

1. **启动系统**（展示初始化日志）
2. **注册新用户**（展示EnumSet多角色）
3. **买家浏览商品**（展示搜索和排序）
4. **买家下单**（展示RESERVED状态）
5. **卖家确认**（展示观察者通知）
6. **买家收货**（展示状态流转）
7. **买家评价**（展示信誉分更新）
8. **查看消息**（展示消息通知历史）
9. **管理员功能**（展示权限控制）
10. **查看数据文件**（展示JSON持久化）

### 技术亮点讲解顺序

1. **架构设计** - AppContext依赖注入
2. **设计模式** - 5种模式的应用场景
3. **EnumSet** - 为什么选择EnumSet
4. **RESERVED状态** - 解决了什么问题
5. **观察者模式** - 生命周期管理
6. **数据持久化** - 自定义TypeAdapter

---

## 📞 技术支持

如有问题，请检查：
1. JDK版本是否为17
2. Gson库是否正确放置在 `lib/` 目录
3. 编译时是否包含 `-encoding UTF-8` 参数
4. 运行时classpath是否正确

---

**祝您使用愉快！🎉**


